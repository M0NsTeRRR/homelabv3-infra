---
# yaml-language-server: $schema=https://raw.githubusercontent.com/M0NsTeRRR/helm-charts/main/charts/kea-exporter/values.schema.json
podAnnotations:
  reloader.stakater.com/auto: "true"
volumes:
  - name: ca-certs
    configMap:
      name: homelab-ca
  - name: client-mtls
    secret:
      secretName: client-mtls
volumeMounts:
  - name: ca-certs
    mountPath: /etc/ssl/certs/homelab.crt
    subPath: ca.crt
    readOnly: true
  - name: client-mtls
    mountPath: /mtls/client
    readOnly: true
extraEnv:
  - name: MODE
    value: http
  - name: TARGETS
    value: https://dhcp2.unicornafk.fr:8000
  - name: CLIENT_CERT
    value: /mtls/client/tls.crt
  - name: CLIENT_KEY
    value: /mtls/client/tls.key
  - name: REQUESTS_CA_BUNDLE
    value: /etc/ssl/certs/homelab.crt
serviceMonitor:
  enabled: true
  metricRelabelings:
    - action: replace
      replacement: dhcp2.unicornafk.fr
      sourceLabels:
        - instance
      targetLabel: instance
