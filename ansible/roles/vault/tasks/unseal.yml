---
- name: "Unseal vault-{{ item }}"
  kubernetes.core.k8s_exec:
    namespace: vault
    pod: "vault-{{ item }}"
    command: vault operator unseal {{ unseal_key_hex }}
    kubeconfig: "{{ vault_localhost_kubeconfig_path }}"
    validate_certs: true
  no_log: true
  delegate_to: localhost
  with_items: "{{ vault_init_parsed.unseal_keys_hex[:3] }}"
  loop_control:
    loop_var: unseal_key_hex
